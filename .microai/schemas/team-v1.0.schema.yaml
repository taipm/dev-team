# Team Schema v1.0
# Äá»‹nh nghÄ©a cáº¥u trÃºc chuáº©n cho MicroAI Teams

schema:
  version: "1.0"
  description: "Schema chuáº©n cho team workflow vÃ  cáº¥u trÃºc"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# REQUIRED FIELDS - Báº¯t buá»™c pháº£i cÃ³
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

required:
  # Workflow frontmatter
  workflow:
    name:
      type: string
      format: kebab-case
      description: "Team name (e.g., 'python-team', 'go-team')"
      example: "python-team"

    description:
      type: string
      min_length: 20
      description: "MÃ´ táº£ ngáº¯n vá» team vÃ  má»¥c Ä‘Ã­ch"
      example: "AI Coding Team cho Python development - Full-stack tá»« requirements Ä‘áº¿n release"

    model:
      type: string
      enum: [opus, sonnet, haiku]
      default: opus
      description: "Default model cho team"

    tools:
      type: array
      items: string
      min_items: 1
      description: "Tools team Ä‘Æ°á»£c phÃ©p sá»­ dá»¥ng"
      example: [Read, Write, Edit, Bash, Glob, Task]

    language:
      type: string
      default: vi
      description: "NgÃ´n ngá»¯ giao tiáº¿p chÃ­nh"

  # Team structure
  structure:
    agents:
      type: directory
      required: true
      min_files: 2
      description: "ThÆ° má»¥c chá»©a agent definitions"

    steps:
      type: directory
      required: true
      min_files: 3
      description: "ThÆ° má»¥c chá»©a workflow steps"

    knowledge:
      type: directory
      required: true
      description: "ThÆ° má»¥c chá»©a team knowledge"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# RECOMMENDED FIELDS - Khuyáº¿n nghá»‹ cÃ³
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

recommended:
  # Style
  style:
    color:
      type: string
      format: hex-color
      description: "Team color cho UI"
      example: "#3776AB"

    icon:
      type: string
      description: "Team icon/emoji"
      example: "ğŸ"

  # Output configuration
  output:
    output_folder:
      type: string
      format: path
      description: "ÄÆ°á»ng dáº«n lÆ°u output/logs"
      example: "./.microai/teams/{team_name}/logs"

  # Checkpoint system
  checkpoint:
    enabled:
      type: boolean
      default: true
      description: "Báº­t checkpoint cho session recovery"

    storage_path:
      type: string
      format: path
      description: "ÄÆ°á»ng dáº«n lÆ°u checkpoints"

    git_integration:
      type: boolean
      default: true
      description: "TÃ­ch há»£p vá»›i git branches"

    auto_checkpoint:
      type: boolean
      default: true
      description: "Tá»± Ä‘á»™ng checkpoint sau má»—i step"

  # Communication bus
  communication:
    enabled:
      type: boolean
      default: true
      description: "Báº­t inter-agent communication"

    bus_path:
      type: string
      format: path
      description: "ÄÆ°á»ng dáº«n message bus"

    message_timeout_ms:
      type: integer
      default: 5000
      description: "Timeout cho messages"

    topics:
      type: array
      items: string
      description: "Communication topics"
      example:
        - requirements
        - architecture
        - code_change
        - testing
        - review

  # Kanban tracking
  kanban:
    enabled:
      type: boolean
      default: true
      description: "Báº­t kanban board tracking"

    board_path:
      type: string
      format: path
      description: "ÄÆ°á»ng dáº«n kanban board"

    signals:
      type: object
      description: "Signal configurations"
      properties:
        on_step_start: boolean
        on_step_complete: boolean
        on_agent_activate: boolean

    wip_enforcement:
      type: boolean
      default: true
      description: "Enforce WIP limits"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OPTIONAL FIELDS - TÃ¹y chá»n
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

optional:
  # Autonomous mode
  autonomous:
    enabled:
      type: boolean
      default: false
      description: "Báº­t autonomous mode"

    level:
      type: string
      enum: [cautious, balanced, aggressive]
      default: balanced
      description: "Má»©c Ä‘á»™ autonomous"

    auto_approve:
      type: object
      description: "Nhá»¯ng gÃ¬ Ä‘Æ°á»£c auto-approve"
      properties:
        specs: boolean
        architecture: boolean
        code_changes: boolean
        security_low_medium: boolean
        security_high_critical: boolean

    thresholds:
      type: object
      properties:
        min_coverage:
          type: integer
          default: 80
        max_iterations:
          type: integer
          default: 3

  # Parallel execution
  parallel:
    enabled:
      type: boolean
      default: false
      description: "Báº­t parallel execution"

    max_workers:
      type: integer
      default: 3
      description: "Sá»‘ workers tá»‘i Ä‘a"

    parallelizable_groups:
      type: array
      description: "NhÃ³m steps cÃ³ thá»ƒ cháº¡y song song"
      items:
        type: object
        properties:
          name: string
          steps: array

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DIRECTORY STRUCTURE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

directory_structure:
  description: "Cáº¥u trÃºc thÆ° má»¥c chuáº©n cho team"
  template: |
    .microai/teams/{team_name}/
    â”œâ”€â”€ workflow.md              # Main workflow definition (REQUIRED)
    â”œâ”€â”€ agents/                  # Agent definitions (REQUIRED)
    â”‚   â”œâ”€â”€ {role-1}-agent.md
    â”‚   â”œâ”€â”€ {role-2}-agent.md
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ steps/                   # Workflow steps (REQUIRED)
    â”‚   â”œâ”€â”€ step-01-init.md
    â”‚   â”œâ”€â”€ step-02-{phase}.md
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ knowledge/               # Team knowledge (REQUIRED)
    â”‚   â”œâ”€â”€ knowledge-index.yaml
    â”‚   â”œâ”€â”€ shared/              # Shared across agents
    â”‚   â””â”€â”€ {role}/              # Role-specific
    â”œâ”€â”€ memory/                  # Team memory (RECOMMENDED)
    â”‚   â”œâ”€â”€ context.md
    â”‚   â”œâ”€â”€ sessions.md
    â”‚   â””â”€â”€ learnings.md
    â”œâ”€â”€ templates/               # Output templates (RECOMMENDED)
    â”‚   â””â”€â”€ {output-type}.md
    â”œâ”€â”€ checkpoints/             # Session checkpoints (OPTIONAL)
    â”œâ”€â”€ communication/           # Message bus (OPTIONAL)
    â”œâ”€â”€ kanban/                  # Kanban board (OPTIONAL)
    â””â”€â”€ logs/                    # Session logs (REQUIRED)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# WORKFLOW CONTENT STRUCTURE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

workflow_content:
  sections:
    - name: "Frontmatter (YAML)"
      required: true
      description: "Metadata vÃ  configuration"

    - name: "Team Overview"
      required: true
      description: "Má»¥c tiÃªu, vai trÃ² orchestrator"

    - name: "Team Members Table"
      required: true
      description: "Báº£ng liá»‡t kÃª agents vá»›i role, icon, focus"

    - name: "Workflow Architecture"
      required: true
      description: "Flow diagram ASCII/Mermaid"

    - name: "Configuration"
      required: true
      description: "Paths, session state"

    - name: "Observer Controls"
      required: true
      description: "Commands Ä‘á»ƒ control workflow"

    - name: "Execution Steps"
      required: true
      description: "MÃ´ táº£ tá»«ng step"

    - name: "Error Handling"
      recommended: true
      description: "Xá»­ lÃ½ lá»—i"

    - name: "Exit Conditions"
      recommended: true
      description: "Äiá»u kiá»‡n káº¿t thÃºc"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VALIDATION RULES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

validation:
  workflow:
    - "Frontmatter pháº£i cÃ³ Ä‘á»§ required fields"
    - "Model pháº£i lÃ  opus, sonnet, hoáº·c haiku"
    - "Tools pháº£i lÃ  máº£ng non-empty"
    - "Color pháº£i lÃ  hex format náº¿u cÃ³"

  agents:
    - "Má»—i agent pháº£i cÃ³ frontmatter vá»›i name, description"
    - "Agent name pháº£i match filename"
    - "Pháº£i cÃ³ Ã­t nháº¥t 2 agents"

  steps:
    - "Pháº£i cÃ³ step-01-init.md"
    - "Pháº£i cÃ³ step cuá»‘i (synthesis/close)"
    - "Step naming: step-{NN}-{name}.md"

  knowledge:
    - "Pháº£i cÃ³ knowledge-index.yaml"
    - "Index pháº£i reference files thá»±c sá»± tá»“n táº¡i"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EXAMPLES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

examples:
  minimal_workflow: |
    ---
    name: my-team
    description: AI Team for XYZ development
    model: opus
    tools: [Read, Write, Edit, Bash, Glob, Task]
    language: vi
    ---

    # My Team Workflow

    ## Team Members
    | Agent | Role | Icon |
    |-------|------|------|
    | dev | Developer | ğŸ’» |
    | reviewer | Reviewer | ğŸ” |

    ## Workflow
    ...

  full_workflow: |
    ---
    name: python-team
    description: AI Coding Team cho Python development
    model: opus
    tools: [Read, Write, Edit, Bash, Glob, Task]
    language: vi
    color: "#3776AB"
    output_folder: ./.microai/teams/python-team/logs
    checkpoint:
      enabled: true
      storage_path: ./.microai/teams/python-team/checkpoints
      git_integration: true
      auto_checkpoint: true
    communication:
      enabled: true
      bus_path: ./.microai/teams/python-team/communication
      message_timeout_ms: 5000
      topics: [requirements, architecture, code_change, testing, review]
    kanban:
      enabled: true
      board_path: ./.microai/teams/python-team/kanban/board.yaml
      signals:
        on_step_start: true
        on_step_complete: true
        on_agent_activate: true
      wip_enforcement: true
    autonomous:
      enabled: false
      level: balanced
      thresholds:
        min_coverage: 80
        max_iterations: 3
    parallel:
      enabled: false
      max_workers: 3
    ---

    # Python Team Workflow
    ...
