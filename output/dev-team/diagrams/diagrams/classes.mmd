%% Class Diagram - Agent and Team Schema
%% Generated by Diagram Team - Session DTT-2026-01-04-DIAGRAM-001

classDiagram
    class Agent {
        +String id
        +String name
        +String title
        +String icon
        +String color
        +String model
        +String language
        +String[] tags
        +String version
    }

    class AgentInstruction {
        +String system
        +String[] must
        +String[] must_not
    }

    class AgentCapabilities {
        +String[] tools
        +String[] skills
        +Knowledge knowledge
    }

    class AgentPersona {
        +String[] style
        +String[] principles
    }

    class AgentReasoning {
        +Map~String, String[]~ patterns
    }

    class AgentMenu {
        +String cmd
        +String trigger
        +String workflow
        +String description
    }

    class AgentActivation {
        +String on_start
        +Boolean critical
    }

    class AgentMemory {
        +Boolean enabled
        +String[] files
        +String[] session_end
    }

    class Team {
        +String name
        +String description
        +String model
        +String[] tools
        +String language
        +String color
        +String icon
        +String output_folder
    }

    class TeamCheckpoint {
        +Boolean enabled
        +String storage_path
        +Boolean git_integration
        +Boolean auto_checkpoint
    }

    class TeamCommunication {
        +Boolean enabled
        +String bus_path
        +Integer message_timeout_ms
        +String[] topics
    }

    class TeamKanban {
        +Boolean enabled
        +String board_path
        +Map signals
        +Boolean wip_enforcement
    }

    class TeamParallel {
        +Boolean enabled
        +Integer max_workers
        +ParallelGroup[] parallelizable_groups
    }

    class Workflow {
        +String name
        +String description
        +String version
        +Phase[] phases
        +ErrorHandling error_handling
    }

    class Phase {
        +String id
        +String name
        +String description
        +Step[] steps
        +String condition
    }

    class Step {
        +String id
        +String name
        +String action
        +String template
        +String output
        +Map validation
    }

    class Knowledge {
        +String index
        +String base_path
        +String[] templates
        +SharedKnowledge shared
    }

    class SharedKnowledge {
        +String registry
        +String[] auto_load
        +Map~String, String[]~ on_demand
    }

    class KnowledgeRegistry {
        +String version
        +Map~String, KnowledgeEntry~ universal
        +Map~String, KnowledgeEntry~ domains
        +Map~String, KnowledgeEntry~ roles
        +Map~String, AgentMapping~ agents
        +TokenBudgets budgets
    }

    class KnowledgeEntry {
        +String file
        +String source
        +Integer tokens
        +String[] tags
        +String[] depends_on
        +String description
        +String status
    }

    class KanbanBoard {
        +String name
        +String type
        +String session_id
        +Map~String, Column~ columns
        +Map~String, AgentStats~ agents
        +WorkflowState workflow
        +Metrics metrics
    }

    class Column {
        +String name
        +String description
        +String step
        +String agent
        +Integer order
        +Integer wip_limit
        +Task[] tasks
    }

    Agent "1" *-- "1" AgentInstruction : instruction
    Agent "1" *-- "1" AgentCapabilities : capabilities
    Agent "1" *-- "1" AgentPersona : persona
    Agent "1" *-- "1" AgentReasoning : reasoning
    Agent "1" *-- "*" AgentMenu : menu
    Agent "1" *-- "1" AgentActivation : activation
    Agent "1" *-- "0..1" AgentMemory : memory

    AgentCapabilities "1" *-- "1" Knowledge : knowledge
    Knowledge "1" *-- "0..1" SharedKnowledge : shared
    SharedKnowledge "1" --> "1" KnowledgeRegistry : references

    Team "1" *-- "0..1" TeamCheckpoint : checkpoint
    Team "1" *-- "0..1" TeamCommunication : communication
    Team "1" *-- "0..1" TeamKanban : kanban
    Team "1" *-- "0..1" TeamParallel : parallel
    Team "1" *-- "*" Agent : agents
    Team "1" *-- "1" Workflow : workflow

    Workflow "1" *-- "*" Phase : phases
    Phase "1" *-- "*" Step : steps

    TeamKanban "1" --> "1" KanbanBoard : board
    KanbanBoard "1" *-- "*" Column : columns

    KnowledgeRegistry "1" *-- "*" KnowledgeEntry : entries
